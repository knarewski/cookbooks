<%= node["hg_rails"]["env"] %>:
  adapter: <%= node["hg_rails"]["database"]["adapter"] %>
  database: <%= node["hg_rails"]["database"]["database"] %>
  username: <%= node["hg_rails"]["database"]["username"] %>
  password: <%= node["hg_rails"]["database"]["password"]%>
<% if node["hg_rails"]["database"]["host"] %>
  host: <%= node["hg_rails"]["database"]["host"] %>
<% end %>
<% if node["hg_rails"]["database"]["encoding"] %>
  encoding: <%= node["hg_rails"]["database"]["encoding"] %>
<% end %>
  reconnect: true
  port: <%= node["hg_rails"]["database"]["port"] %>
  pool: <%= node["hg_rails"]["database"]["pool"] %>

<% if node["hg_rails"]["database"]["additional_databases"].any? %>
  <% node["hg_rails"]["database"]["additional_databases"].each do |database_name, database_hash| %>
<%= { database_name => { node["hg_rails"]["env"] => database_hash.to_hash } }.to_yaml.split("\n")[1..-1].join("\n") %>
  <% end %>
<% end  %>
